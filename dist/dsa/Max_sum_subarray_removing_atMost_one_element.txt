// Date: 05/01/2026
// Problem: https://leetcode.com/problems/maximum-subarray-sum-with-one-deletion/

import java.lang.*;
import java.util.*;

class Main {

  public static void main(String[] args) {
    int[] arr = { 6, -1, -8, 4, 5 };
    int result = maxSumSubArrayRemovingOneElement(arr);
    System.out.println("Result: " + result);
  }

  static int maxSumSubArrayRemovingOneElement(int[] arr) {
    // forward[i] stores max subarray sum ending at i
    int[] forward = new int[arr.length];
    // backward[i] stores max subarray sum starting at i
    int[] backward = new int[arr.length];

    int curr = arr[0];
    int maxSoFar = arr[0];
    forward[0] = arr[0];

    // Fill forward array (Kadane's)
    for (int i = 1; i < arr.length; i++) {
      curr = Math.max(arr[i], curr + arr[i]);
      maxSoFar = Math.max(maxSoFar, curr);
      forward[i] = curr;
    }

    curr = arr[arr.length - 1];
    backward[arr.length - 1] = arr[arr.length - 1];

    // Fill backward array
    for (int i = arr.length - 2; i >= 0; i--) {
      curr = Math.max(arr[i], curr + arr[i]);
      backward[i] = curr;
    }

    int res = maxSoFar;

    // Try removing element at i, connecting forward[i-1] and backward[i+1]
    for (int i = 1; i < arr.length - 1; i++) {
      res = Math.max(res, forward[i - 1] + backward[i + 1]);
    }

    return res;
  }
}
